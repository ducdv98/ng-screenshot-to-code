<div class="code-viewer w-full h-full flex flex-col">
  @if (!showSingleEditor) {
    <div class="flex justify-between items-center mb-2">
      <div class="text-lg font-medium">
        @if (generatedCode) {
          Component: <span class="font-bold">{{ generatedCode.component_name }}.component</span>
        } @else {
          Generated Code
        }
      </div>
      
      <div class="actions">
        <button 
          mat-button 
          color="primary"
          matTooltip="Download all files"
          [disabled]="!generatedCode"
          (click)="downloadAllFiles()"
          aria-label="Download all component files">
          <mat-icon aria-hidden="true">download</mat-icon> Download Files
        </button>
      </div>
    </div>

    <mat-tab-group class="flex-grow" (selectedTabChange)="announceSelectedTab($event)">
      <!-- TypeScript -->
      <mat-tab label="TypeScript" aria-label="TypeScript code tab">
        <div class="flex justify-between items-center p-2">
          <span class="text-sm">{{ generatedCode?.component_name || 'component' }}.component.ts</span>
          <button 
            mat-icon-button 
            matTooltip="Copy TypeScript code"
            [disabled]="!generatedCode"
            (click)="copyCode('ts')"
            aria-label="Copy TypeScript code to clipboard">
            <mat-icon aria-hidden="true">content_copy</mat-icon>
          </button>
        </div>
        <div #tsEditor class="editor-container" role="region" aria-label="TypeScript code editor"></div>
      </mat-tab>
      
      <!-- HTML -->
      <mat-tab label="HTML" aria-label="HTML code tab">
        <div class="flex justify-between items-center p-2">
          <span class="text-sm">{{ generatedCode?.component_name || 'component' }}.component.html</span>
          <button 
            mat-icon-button 
            matTooltip="Copy HTML code"
            [disabled]="!generatedCode"
            (click)="copyCode('html')"
            aria-label="Copy HTML code to clipboard">
            <mat-icon aria-hidden="true">content_copy</mat-icon>
          </button>
        </div>
        <div #htmlEditor class="editor-container" role="region" aria-label="HTML code editor"></div>
      </mat-tab>
      
      <!-- SCSS -->
      <mat-tab label="SCSS" aria-label="SCSS code tab">
        <div class="flex justify-between items-center p-2">
          <span class="text-sm">{{ generatedCode?.component_name || 'component' }}.component.scss</span>
          <button 
            mat-icon-button 
            matTooltip="Copy SCSS code"
            [disabled]="!generatedCode"
            (click)="copyCode('scss')"
            aria-label="Copy SCSS code to clipboard">
            <mat-icon aria-hidden="true">content_copy</mat-icon>
          </button>
        </div>
        <div #scssEditor class="editor-container" role="region" aria-label="SCSS code editor"></div>
      </mat-tab>
    </mat-tab-group>
  } @else {
    <!-- Single Editor Mode -->
    <div class="flex justify-between items-center p-2">
      <span class="text-sm">{{ fileName || 'Code' }}</span>
      <button 
        mat-icon-button 
        matTooltip="Copy code"
        [disabled]="!code"
        (click)="copyCode('single')"
        aria-label="Copy code to clipboard">
        <mat-icon aria-hidden="true">content_copy</mat-icon>
      </button>
    </div>
    <div #singleEditor class="editor-container" role="region" [attr.aria-label]="fileName ? fileName + ' code editor' : 'Code editor'"></div>
  }
  
  <!-- Screen reader announcements -->
  <div aria-live="assertive" class="sr-only">
    {{ screenReaderMessage }}
  </div>
</div>

<style>
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }
</style> 